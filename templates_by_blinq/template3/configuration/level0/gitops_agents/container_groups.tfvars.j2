container_groups = {
  {{ ignite.global.caf_environment }} = {
    containers = {
      rover_{{ ignite.global.caf_environment }} = {
        cpu = 3
        environment_variables = {
          AGENT_NAME   = "rover-{{ ignite.global.caf_environment }}"
          LABELS       = "rover-{{ ignite.global.caf_environment }}"
          LABELS       = "platform"
          ROVER_RUNNER = true
          URL          = "https://github.com/{{ ignite.global.caf_environment }}as/azlz-{{ ignite.global.caf_environment }}"
        }
        image  = "aztfmod/rover-agent:1.3.6-2212.011747-preview-github"
        memory = 3
        name   = "rover-{{ ignite.global.caf_environment }}"
        ports = {
          ssh = {
            port     = 22
            protocol = "TCP"
          }
        }
        secure_variables_from_command = {
          AGENT_TOKEN = "gh api --method POST -H 'Accept: application/vnd.github.v3+json' /repos/{{ ignite.global.caf_environment }}as/azlz-{{ ignite.global.caf_environment }}/actions/runners/registration-token | jq -r ' {value: .token}'"
        }
      }
    }
    ip_address_type = "Private"
    name            = "rover-{{ ignite.global.caf_environment }}"
    os_type         = "Linux"
    region          = "region1"
    resource_group = {
      key    = "gitops"
      lz_key = "launchpad"
    }
    restart_policy = "Never"
    subnet_ids = {
      subnet1 = {
        lz_key     = "launchpad"
        subnet_key = "containergroups"
        vnet_key   = "vnet_region1"
      }
    }
  }
}
